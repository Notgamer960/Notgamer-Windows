local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "ESP_GUI"
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

local ToggleButton = Instance.new("TextButton")
ToggleButton.Size = UDim2.new(0, 150, 0, 50)
ToggleButton.Position = UDim2.new(0.05, 0, 0.1, 0)
ToggleButton.Text = "Toggle ESP"
ToggleButton.Parent = ScreenGui
ToggleButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)

local ESPEnabled = false

local keywords = { "chest", "crate", "treasure", "coal", "gas", "oil", "fuel" }

local function isTargetModel(model)
	if not model:IsA("Model") then return false end

	local name = string.lower(model.Name)
	for _, word in ipairs(keywords) do
		if string.find(name, word) then
			return true
		end
	end

	return false
end

local function addESP(model)
	if isTargetModel(model) then
		if not model:FindFirstChild("ESP_Billboard") then
			local attachPart = model.PrimaryPart or model:FindFirstChildWhichIsA("BasePart")
			if attachPart then
				local billboard = Instance.new("BillboardGui")
				billboard.Name = "ESP_Billboard"
				billboard.AlwaysOnTop = true
				billboard.Size = UDim2.new(0, 100, 0, 50)
				billboard.StudsOffset = Vector3.new(0, 3, 0)
				billboard.Adornee = attachPart
				billboard.Parent = model

				local label = Instance.new("TextLabel")
				label.Size = UDim2.new(1, 0, 1, 0)
				label.BackgroundTransparency = 1
				label.Text = model.Name
				label.TextColor3 = Color3.fromRGB(170, 0, 255)
				label.TextStrokeTransparency = 0
				label.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
				label.TextScaled = true
				label.Parent = billboard
			end
		end
	end
end

local function enableESP()
	for _, obj in ipairs(workspace:GetDescendants()) do
		addESP(obj)
	end

	workspace.DescendantAdded:Connect(function(obj)
		if ESPEnabled then
			addESP(obj)
		end
	end)
end

local function disableESP()
	for _, model in ipairs(workspace:GetDescendants()) do
		local esp = model:FindFirstChild("ESP_Billboard")
		if esp then esp:Destroy() end
	end
end

ToggleButton.MouseButton1Click:Connect(function()
	ESPEnabled = not ESPEnabled
	if ESPEnabled then
		ToggleButton.Text = "ESP ON"
		enableESP()
	else
		ToggleButton.Text = "ESP OFF"
		disableESP()
	end
end)
