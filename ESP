local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "ESP_GUI"
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

local ToggleButton = Instance.new("TextButton")
ToggleButton.Size = UDim2.new(0, 150, 0, 50)
ToggleButton.Position = UDim2.new(0.05, 0, 0.1, 0)
ToggleButton.Text = "Toggle ESP"
ToggleButton.Parent = ScreenGui
ToggleButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)

local ESPEnabled = false

local keywords = { "chest", "treasure", "coal", "gas", "oil", "fuel" }

local customNames = {
	["Chest Lid"] = "",
	["ChestLid"] = "",
	["Chest lid"] = "",
	["chest lid"] = "",
	["Chestlid"] = "",
	["chestlid"] = "",
	["Item"] = "",
	["item"] = "",
	["Item Chest"] = "Wooden Chest",
	["ItemChest"] = "Wooden Chest",
	["Item Chest2"] = "Good Chest",
	["ItemChest2"] = "Good Chest",
	["Item Chest3"] = "Iron Chest",
	["ItemChest3"] = "Iron Chest",
	["Item Chest4"] = "Legendary Chest",
	["ItemChest4"] = "Legendary Chest",
	["ItemChest5"] = "Gold Chest",
	["Item Chest5"] = "Gold Chest",
	["ItemChest6"] = "Ruby Chest",
	["Item Chest6"] = "Ruby Chest",
}

local function isTargetModel(model)
	if not model:IsA("Model") then return false end

	local name = string.lower(model.Name)
	for _, word in ipairs(keywords) do
		if string.find(name, word) then
			return true
		end
	end

	return false
end

local function addESP(model)
	if isTargetModel(model) then
		if not model:FindFirstChild("ESP_Billboard") then
			local attachPart = model.PrimaryPart or model:FindFirstChildWhichIsA("BasePart")
			if attachPart then
				local billboard = Instance.new("BillboardGui")
				billboard.Name = "ESP_Billboard"
				billboard.AlwaysOnTop = true
				billboard.Size = UDim2.new(0, 120, 0, 50)
				billboard.StudsOffset = Vector3.new(0, 3, 0)
				billboard.Adornee = attachPart
				billboard.Parent = model

				local label = Instance.new("TextLabel")
				label.Size = UDim2.new(1, 0, 1, 0)
				label.BackgroundTransparency = 1
				label.Text = customNames[model.Name] or model.Name
				label.TextColor3 = Color3.fromRGB(170, 0, 255)
				label.TextStrokeTransparency = 0
				label.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
				label.TextScaled = true
				label.Parent = billboard
			end
		end

		if not model:FindFirstChild("ESP_Highlight") then
			local highlight = Instance.new("Highlight")
			highlight.Name = "ESP_Highlight"
			highlight.FillTransparency = 1
			highlight.OutlineTransparency = 0
			highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
			highlight.Parent = model
		end
	end
end

local function enableESP()
	for _, obj in ipairs(workspace:GetDescendants()) do
		addESP(obj)
	end

	workspace.DescendantAdded:Connect(function(obj)
		if ESPEnabled then
			addESP(obj)
		end
	end)
end

local function disableESP()
	for _, model in ipairs(workspace:GetDescendants()) do
		local esp1 = model:FindFirstChild("ESP_Billboard")
		if esp1 then esp1:Destroy() end
		local esp2 = model:FindFirstChild("ESP_Highlight")
		if esp2 then esp2:Destroy() end
	end
end

ToggleButton.MouseButton1Click:Connect(function()
	ESPEnabled = not ESPEnabled
	if ESPEnabled then
		ToggleButton.Text = "ESP ON"
		enableESP()
	else
		ToggleButton.Text = "ESP OFF"
		disableESP()
	end
end)
